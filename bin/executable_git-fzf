#!/bin/bash

extra_opts="$@"
branch=$(git branch $extra_opts | sed -e 's/ *//' | fzf --print-query)

IFS=$'\n' read -rd '' input branch <<<"$branch"

if [ -z "$branch" ]; then
    # chose an item not in the list, offer to make it.
    printf "Create branch? [Ny] "
    read response
    case "$response" in
        Y|y)
            git checkout -b "$input"
            ;;
        N|n|"")
            echo "No branch by that name."
            ;;
        *)
            echo "Not handled: '$response'"
            ;;
    esac
else
    case "$branch" in
        '*'*)
            echo "Already on that branch."
            ;;
        *)
            git checkout $branch
            ;;
    esac
fi
